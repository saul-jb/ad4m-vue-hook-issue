<template>
  <div v-if="hasPerspective" :class="styles.appContainer">
    <Suspense>
      <TodoView :perspective="perspective" :source="source" :timeout="0" />
    </Suspense>

    <Suspense>
      <TodoView :perspective="perspective" :source="source" :timeout="1000" />
    </Suspense>
  </div>

  <template v-else>
    No perspective or agent client
  </template>
</template>

<script setup lang="ts">
import styles from "./Plugin.module.css";
import type { PerspectiveProxy } from "@coasys/ad4m";
import type { AgentClient } from "@coasys/ad4m";
import { computed } from 'vue';
import TodoView from "./components/TodoView.vue";

type Props = Partial<{
  agent: AgentClient;
  perspective: PerspectiveProxy;
  source: string;
}>

const { perspective, agent, source } = defineProps<Props>();

const hasPerspective = computed(
  () => perspective?.uuid != null && agent != null
)
</script>
